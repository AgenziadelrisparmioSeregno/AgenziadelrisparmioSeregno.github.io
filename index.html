<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agenzia del Risparmio | Dashboard Smart</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-blue: #00f3ff;
            --neon-green: #39ff14;
            --bg-deep: #02060c;
            --card-bg: rgba(255, 255, 255, 0.05);
        }

        body {
            background-color: var(--bg-deep);
            color: white;
            font-family: 'Inter', sans-serif;
            margin: 0;
            overflow-x: hidden;
            background: radial-gradient(circle at 50% -20%, #102a44, #02060c);
        }

        h1, h2, .tech-font { font-family: 'Orbitron', sans-serif; text-transform: uppercase; letter-spacing: 2px; }

        .container { max-width: 1400px; margin: 0 auto; padding: 40px; }

        /* HEADER & HERO */
        .hero { display: grid; grid-template-columns: 1fr 1fr; gap: 50px; align-items: start; min-height: 85vh; }
        .hero-text h1 { font-size: 3rem; line-height: 1.1; margin-bottom: 20px; }
        .hero-text span { color: var(--neon-blue); }

        /* GRID CONSULENTI */
        .agent-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 30px; }
        .agent-card {
            background: var(--card-bg);
            border: 1px solid rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: 0.3s;
            text-align: left;
        }
        .agent-card:hover { border-color: var(--neon-blue); background: rgba(0, 243, 255, 0.05); transform: translateY(-5px); }
        .agent-card strong { display: block; font-size: 1.1rem; color: var(--neon-blue); }
        .agent-card small { color: #888; text-transform: uppercase; font-size: 0.7rem; }

        /* CHAT BOX 3D */
        .chat-window {
            background: rgba(15, 42, 68, 0.5);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 30px;
            height: 600px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 50px rgba(0,0,0,0.5);
        }
        .chat-header { padding: 20px; border-bottom: 1px solid rgba(255,255,255,0.1); display: flex; align-items: center; gap: 10px; }
        .online-dot { width: 10px; height: 10px; background: var(--neon-green); border-radius: 50%; box-shadow: 0 0 10px var(--neon-green); }
        
        .chat-messages { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px; }
        .msg { padding: 15px 20px; border-radius: 18px; max-width: 80%; line-height: 1.5; font-size: 0.95rem; }
        .bot { background: rgba(0, 243, 255, 0.1); border-left: 4px solid var(--neon-blue); align-self: flex-start; }
        .user { background: var(--card-bg); border: 1px solid rgba(255,255,255,0.1); align-self: flex-end; }

        .chat-input-area { padding: 20px; border-top: 1px solid rgba(255,255,255,0.1); display: flex; gap: 10px; }
        input { flex: 1; background: transparent; border: none; color: white; outline: none; font-size: 1rem; }

        /* BOTTONI */
        .btn {
            background: var(--neon-blue);
            color: #000;
            padding: 12px 25px;
            border-radius: 10px;
            font-weight: bold;
            text-decoration: none;
            display: inline-block;
            transition: 0.3s;
            border: none;
            cursor: pointer;
            font-family: 'Inter', sans-serif;
        }
        .btn:hover { box-shadow: 0 0 20px var(--neon-blue); transform: scale(1.02); }
        .btn-wa { background: #25D366; color: white; margin-top: 10px; }

        /* COMPARATORE */
        #comparator { display: none; margin-top: 50px; animation: fadeIn 0.5s; }
        .offer-row {
            background: var(--card-bg);
            margin-bottom: 15px;
            padding: 25px;
            border-radius: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 5px solid transparent;
        }
        .best-offer { border-left-color: var(--neon-green); background: linear-gradient(90deg, rgba(57, 255, 20, 0.05), transparent); }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="container">
    <div class="hero">
        <div class="hero-text">
            <h1>Agenzia del <span>Risparmio</span></h1>
            <p style="color: #aaa; font-size: 1.1rem;">Benvenuto nel futuro della consulenza energetica. 
            Il nostro algoritmo analizza i mercati per te. Scegli un esperto o fai tutto in autonomia.</p>
            
            <div class="agent-grid">
                <div class="agent-card" onclick="startAgent('Daniel', '3423218269', 'Luce e Gas')">
                    <small>Energy Manager</small>
                    <strong>DANIEL</strong>
                </div>
                <div class="agent-card" onclick="startAgent('Daniele', '3491795387', 'Analisi Tecnica')">
                    <small>Technical Advisor</small>
                    <strong>DANIELE</strong>
                </div>
                <div class="agent-card" onclick="startAgent('Andrea', '3515910955', 'Fotovoltaico')">
                    <small>Solar Specialist</small>
                    <strong>ANDREA</strong>
                </div>
                <div class="agent-card" onclick="startAgent('Luca', '3277545377', 'CAF e Fisco')">
                    <small>Tax Expert</small>
                    <strong>LUCA</strong>
                </div>
            </div>

            <button class="btn" style="width: 100%; margin-top: 20px; background: transparent; border: 1px solid var(--neon-green); color: var(--neon-green);" onclick="runComparator()">
                AVVIA COMPARAZIONE AUTONOMA
            </button>
        </div>

        <div class="chat-window">
            <div class="chat-header">
                <div class="online-dot"></div>
                <strong>SMART ASSISTANT</strong>
            </div>
            <div class="chat-messages" id="chatbox">
                <div class="msg bot">Ciao! Sono l'intelligenza di Agenzia del Risparmio. <br><br>Hai bisogno di aiuto con le bollette, vuoi informazioni sul fotovoltaico o ti servono servizi CAF?</div>
            </div>
            <div class="chat-input-area">
                <input type="text" id="userInput" placeholder="Scrivi qui la tua domanda...">
                <button class="btn" onclick="processInput()">INVIA</button>
            </div>
        </div>
    </div>

    <div id="comparator">
        <h2 class="tech-font" style="color: var(--neon-blue);">Analisi Comparativa Risultati</h2>
        <div id="offers-container"></div>
    </div>
</div>

<script>
    const chatbox = document.getElementById('chatbox');

    function addMsg(text, sender) {
        const div = document.createElement('div');
        div.className = `msg ${sender}`;
        div.innerHTML = text;
        chatbox.appendChild(div);
        chatbox.scrollTop = chatbox.scrollHeight;
    }

    // GESTIONE CONSULENTI
    function startAgent(name, phone, specialty) {
        addMsg(`Vorrei parlare con ${name} per ${specialty}`, 'user');
        setTimeout(() => {
            addMsg(`<strong>NOTIFICA:</strong> ${name} è attualmente impegnato in una consulenza tecnica.`, 'bot');
            addMsg(`Per non farti aspettare, puoi inviargli direttamente i tuoi dati su WhatsApp. Ti risponderà in pochi minuti: <br><br> <a href="https://wa.me/39${phone}?text=Ciao%20${name},%20ti%20scrivo%20dal%20sito.%20Ho%20bisogno%20di%20assistenza." class="btn btn-wa" target="_blank">PARLA CON ${name.toUpperCase()}</a>`, 'bot');
        }, 800);
    }

    // LOGICA RISPOSTE INTELLIGENTI
    function processInput() {
        const input = document.getElementById('userInput');
        const text = input.value.trim();
        if(!text) return;

        addMsg(text, 'user');
        input.value = "";

        setTimeout(() => {
            const val = text.toLowerCase();
            
            if(val.includes("bolletta") || val.includes("luce") || val.includes("gas")) {
                addMsg("Le tariffe attuali sono in forte fluttuazione. Ho attivato il comparatore per mostrarti quanto puoi risparmiare con le nostre offerte partner.", "bot");
                runComparator();
            } 
            else if(val.includes("foto") || val.includes("pannelli") || val.includes("sole")) {
                addMsg("Il fotovoltaico permette un abbattimento fino all'80% della bolletta. <b>Andrea</b> è il nostro specialista. Clicca sul suo profilo per uno studio di fattibilità gratuito.", "bot");
            }
            else if(val.includes("caf") || val.includes("isee") || val.includes("730") || val.includes("tasse")) {
                addMsg("Per pratiche CAF e Bonus fiscali, il referente è <b>Luca</b>. Puoi scrivergli ora per fissare un appuntamento in ufficio o da remoto.", "bot");
            }
            else if(val.includes("ciao") || val.includes("info")) {
                addMsg("Ciao! Come posso esserti utile? Seleziona un consulente o chiedimi pure di confrontare le tue tariffe.", "bot");
            }
            else {
                addMsg("Ricevuto. Per una risposta precisa, ti consiglio di contattare uno dei nostri esperti qui a sinistra o di avviare il calcolo automatico del risparmio.", "bot");
            }
        }, 1000);
    }

    // MOTORE DI COMPARAZIONE (STILE FACILE.IT)
    function runComparator() {
        addMsg("Caricamento database offerte in corso...", "bot");
        const container = document.getElementById('comparator');
        const list = document.getElementById('offers-container');
        container.style.display = 'block';
        list.innerHTML = "";

        const db = [
            { name: "Agenzia Partner: Promo Risparmio", price: "62€", best: true, desc: "Prezzo bloccato + Assistenza Daniel inclusa" },
            { name: "Global Energy Market", price: "88€", best: false, desc: "Tariffa variabile senza assistenza" },
            { name: "Agenzia Partner: Green Solar", price: "65€", best: true, desc: "Energia 100% Rinnovabile + Tutor dedicato" },
            { name: "Fornitore Tradizionale Nazionale", price: "102€", best: false, desc: "Costi fissi di commercializzazione elevati" }
        ];

        db.sort((a,b) => b.best - a.best); // Mette le tue (best:true) in alto

        db.forEach((o, i) => {
            setTimeout(() => {
                const row = document.createElement('div');
                row.className = `offer-row ${o.best ? 'best-offer' : ''}`;
                row.innerHTML = `
                    <div>
                        <strong style="color:${o.best ? 'var(--neon-green)' : '#aaa'}">${o.best ? '⭐ NOSTRA SELEZIONE' : 'MERCATO STANDARD'}</strong>
                        <div style="font-size: 1.3rem; margin: 5px 0;">${o.name}</div>
                        <small style="color:#777">${o.desc}</small>
                    </div>
                    <div style="text-align:right">
                        <div style="font-size: 2rem; font-weight: bold; color: ${o.best ? 'var(--neon-green)' : 'white'}">${o.price}</div>
                        <button class="btn" style="padding: 5px 15px; font-size: 0.8rem;">VEDI DETTAGLI</button>
                    </div>
                `;
                list.appendChild(row);
                if(i === 0) window.scrollTo({ top: container.offsetTop - 50, behavior: 'smooth' });
            }, i * 400);
        });
    }
</script>

</body>
</html>
